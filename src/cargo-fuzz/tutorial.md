# Tutorial

For this tutorial, we're going to be fuzzing the URL parsing crate [rust-url][]. Our goal here is to find some input generated by the fuzzer such that, when passed to `Url::parse`, it causes some sort of panic or crash to happen.

To start, clone the rust-url repository and change directories into it:

```sh
git clone https://github.com/servo/rust-url.git
cd rust-url
```

Although we could fuzz the latest commit on `master`, we're going to checkout a specific revision that is known to have a parsing bug:

```sh
git checkout bfa167b4e0253642b6766a7aa74a99df60a94048
```

Initialize cargo-fuzz:

```sh
cargo fuzz init
```

This will create a directory called `fuzz` which will contain a collection of *fuzzing targets*. Each fuzz target is a Rust program that is given random data and tests a crate (in this case, rust-url). `cargo fuzz init` automatically generates an initial fuzz target for us:

```sh
cargo fuzz list
```

The source code for this fuzz target lives in `fuzz/fuzzers/<fuzz target name>.rs`. Open that file and edit it to look like this:

```ignore,rust
#![no_main]
#[macro_use] extern crate libfuzzer_sys;
extern crate url;

fuzz_target!(|data: &[u8]| {
    if let Ok(s) = std::str::from_utf8(data) {
        let _ = url::Url::parse(s);
    }
});
```

Random data is generated and passed as parameter `data` to the closure. The generated data is a bytes slice, so we'll need to convert it to a utf8 `&str` since rust-url expect that when parsing.

To being fuzzing, run:

```
cargo fuzz run <fuzz target name>
```

You're fuzzing!

rust-url: https://github.com/servo/rust-url
